{% extends 'clinic/base.html' %}
{% block content %}

{% if messages %}
<div class="mb-3">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {% endfor %}
</div>
{% endif %}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Patient Database</h2>

    <div class="d-flex gap-2 align-items-center">
        <form method="GET" class="d-flex" style="max-width: 320px; width: 100%;">
            <input type="text" name="q" value="{{ query }}"
                   class="form-control me-2" placeholder="Search">
            <button type="submit" class="btn btn-primary">Search</button>
        </form>
            </div>
</div>

<table class="table table-striped table-hover bg-white border">
    <thead class="table-dark">
        <tr>
            <th>Surname</th>
            <th>First Name</th>
            <th>Middle Name</th>
            <th>Suffix</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for patient in patients %}
        <tr>
            <td>{{ patient.last_name }}</td>
            <td>{{ patient.first_name }}</td>
            <td>{{ patient.middle_name|default:"" }}</td>
            <td>{{ patient.suffix|default:"" }}</td>
            <td>
                <div class="d-flex gap-2">
                    <a href="{% url 'patient_details' patient.patient_id %}"
                       class="btn btn-info btn-sm text-white">Details</a>
                    <a href="{% url 'patient_update' patient.patient_id %}"
                       class="btn btn-warning btn-sm text-white">Update</a>
                </div>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" class="text-center">
                No patients found{% if query %} for "{{ query }}"{% endif %}.
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}